{% extends "webui/base.html" %}

{% block content %}

<section class="space-y-10">
    <div class="flex flex-col gap-3">
        <p class="text-xs uppercase tracking-[0.4em] text-indigo-400 font-semibold">Observabilidade</p>
        <h2 class="text-3xl font-semibold text-gray-900">Logs de Execução</h2>
        <p class="text-gray-600 max-w-3xl">
            Cada evento simulado ou recebido registra um traço completo: evento acionado, ação executada,
            timestamp e payload. Utilize esta trilha para depurar fluxos e validar integrações.
        </p>
    </div>

    <div class="grid gap-4 md:grid-cols-3">
        <div class="rounded-2xl border border-indigo-100 bg-white p-5 shadow-sm">
            <p class="text-xs uppercase tracking-widest text-indigo-400 font-semibold">Registros</p>
            <p class="text-4xl font-bold text-indigo-700 mt-2">{{ logs|length if logs else 0 }}</p>
            <p class="text-sm text-gray-600 mt-1">Quantidade total de entradas armazenadas.</p>
        </div>
        <div class="rounded-2xl border border-indigo-100 bg-indigo-50/70 p-5">
            <p class="text-xs uppercase tracking-widest text-indigo-400 font-semibold">Insights</p>
            <p class="text-sm text-gray-700 mt-2">Procure por padrões de eventos repetidos para identificar fluxos críticos.</p>
        </div>
        <div class="rounded-2xl border border-indigo-50 bg-white p-5 shadow-sm">
            <p class="text-xs uppercase tracking-widest text-indigo-400 font-semibold">Dica</p>
            <p class="text-sm text-gray-700 mt-2">Se o payload for grande, copie diretamente do bloco abaixo para reprocessar.</p>
        </div>
    </div>

    {% if logs %}
    <div class="relative">
        <span class="absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-indigo-200 via-indigo-300 to-transparent"></span>
        <div class="space-y-6">
            {% for log in logs %}
            <article class="relative pl-12">
                <span class="absolute left-0 top-3 w-8 h-8 rounded-full bg-white border border-indigo-100 shadow flex items-center justify-center text-indigo-600">
                    {{ loop.length - loop.index0 }}
                </span>
                <div class="bg-white/90 border border-indigo-100 rounded-2xl p-5 shadow">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
                        <p class="font-semibold text-indigo-700 text-lg">
                            {{ log.event }} <span class="text-gray-400">→</span> {{ log.action }}
                        </p>
                        <p class="text-sm text-gray-500 font-mono">{{ log.timestamp }}</p>
                    </div>
                    <pre class="mt-4 bg-gray-900 text-gray-100 p-4 rounded-xl overflow-x-auto text-sm leading-relaxed">{{ log.payload }}</pre>
                </div>
            </article>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="text-center p-12 rounded-3xl border border-dashed border-indigo-200 bg-white/80">
        <p class="text-lg font-semibold text-gray-900">Nenhum log registrado ainda</p>
        <p class="text-gray-600 mt-2">
            Simule um evento ou cadastre uma regra para começar a acompanhar execuções aqui.
        </p>
        <a href="{{ url_for('webui.simulate_page') }}"
           class="inline-flex items-center justify-center mt-5 px-5 py-2.5 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition">
            Simular agora
        </a>
    </div>
    {% endif %}
</section>

{% endblock %}
